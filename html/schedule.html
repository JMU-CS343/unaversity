<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Schedule | Unaversity</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Shared global styles (navbar, hero, etc.) -->
  <link rel="stylesheet" href="../css/styles.css">
  <script src="scripts/calander.js"></script>

  <link rel="stylesheet" href="../css/schedule.css">
  <link rel="stylesheet" href="../css/transitions.css">
  <link href="https://fonts.googleapis.com/css2?family=Ultra&display=swap" rel="stylesheet">

  <!-- MAP STUFF (CSS first) -->
  <link rel="stylesheet" href="../css/map.css">

  <!-- Robust loader for map.js + initMap shim -->
  <script>
    (function () {
      // Try ../map.js; if missing, try ../scripts/map.js
      function tryLoad(src, fallback) {
        var s = document.createElement('script');
        s.src = src;
        s.defer = true;
        s.onload = function () { window._mapJsFound = true; };
        s.onerror = function () {
          if (fallback) tryLoad(fallback);
          else console.error('Failed to load map.js from both locations');
        };
        document.head.appendChild(s);
      }
      tryLoad('../map.js', '../scripts/map.js');

      // Shim so Google callback always finds window.initMap.
      function shimInit() {
        if (window._mapJsFound && typeof window.initMap === 'function' && window.initMap !== shimInit) {
          return window.initMap(); // call the real one
        }
        setTimeout(shimInit, 150);
      }
      if (typeof window.initMap !== 'function') {
        window.initMap = shimInit;
      }
    })();
  </script>
</head>

<body>
  <header>
    <!-- Expands at lg and up; collapses below lg (phones + iPad) -->
    <nav id="main-nav" class="navbar navbar-expand-lg" aria-label="Primary">
      <div class="container-fluid">
        <a class="navbar-brand" href="../index.html">U<span style="color:#FFD966;">NAV</span>ERSITY</a>

        <!-- Burger toggler -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#mainMenu" aria-controls="mainMenu" aria-expanded="false"
                aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Collapsible menu -->
        <div class="collapse navbar-collapse" id="mainMenu">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="schedule.html">Schedule</a></li>
            <li class="nav-item"><a class="nav-link" href="#">Stats</a></li>
            <li class="nav-item"><a class="nav-link" href="theme.html">Theme</a></li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <div class="wrapper">
    <!-- Weekday buttons (desktop/tablet only) -->
    <nav id="week-nav" class="d-none d-md-block">
      <ul>
        <li><a  href="#monday">MONDAY</a></li>
        <li><a  href="#tuesday">TUESDAY</a></li>
        <li><a  href="#wednesday">WEDNESDAY</a></li>
        <li><a  href="#thursday">THURSDAY</a></li>
        <li><a  href="#friday">FRIDAY</a></li>
      </ul>
    </nav>

    <!-- Mobile "Weekdays" dropdown (phones only) -->
    <!-- ⬇️ Added id so we can hide/show it when the nav collapses/expands -->
    <div id="weekdays-mobile" class="d-md-none px-3" style="margin-top: 8rem;">
      <div class="dropdown w-100">
        <button class="btn btn-warning w-100 rounded-3 fw-bold dropdown-toggle"
                type="button" data-bs-toggle="dropdown" aria-expanded="false">
          Weekdays
        </button>
        <ul class="dropdown-menu w-100">
          <li><a class="dropdown-item" href="?day=monday">MONDAY</a></li>
          <li><a class="dropdown-item" href="?day=tuesday">TUESDAY</a></li>
          <li><a class="dropdown-item" href="?day=wednesday">WEDNESDAY</a></li>
          <li><a class="dropdown-item" href="?day=thursday">THURSDAY</a></li>
          <li><a class="dropdown-item" href="?day=friday">FRIDAY</a></li>
        </ul>
      </div>
    </div>

    <main>
      Main section for classes
      <ul>
        <li>Example Class</li>
        <li>Example Class</li>
        <li>Example Class</li>
      </ul>
    </main>

    <aside id="map-background">
      <div id="map"></div>
      <div id="map-totals">
        <div id="route-time">Total Time Placeholder</div>
        <div id="route-dist">Total Dist Placeholder</div>
      </div>
      <button id="debug-button">DEBUG: King to E-HALL</button>
    </aside>
  </div>

  <script>
    // Apply saved theme (Include in every page)
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) document.documentElement.setAttribute('data-theme', savedTheme);
  </script>

  <!-- Google Maps API -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB1a1vLs-1g38ba2gVD2yrJfGHBm8sxet4&callback=initMap" async defer></script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    //set current date
    days = ["sunday", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday"];
    
      window.location.hash = days[new Date().getDay()]

  </script>
  
  <!-- Hide mobile "Weekdays" when navbar menu is open -->
  
  <script>
    (function () {
      const menu = document.getElementById('mainMenu');
      const weekdays = document.getElementById('weekdays-mobile');

      if (!menu || !weekdays) return;

      // On load, set initial visibility
      function syncWeekdays() {
        if (menu.classList.contains('show')) {
          weekdays.classList.add('d-none');
        } else {
          weekdays.classList.remove('d-none');
        }
      }

      // Listen to Bootstrap collapse events
      menu.addEventListener('shown.bs.collapse', syncWeekdays);
      menu.addEventListener('hidden.bs.collapse', syncWeekdays);

      // Also run once on load in case the menu starts open/closed
      syncWeekdays();
    })();
  </script>
</body>
</html>
